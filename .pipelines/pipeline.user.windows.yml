environment:
  host:
    os: 'windows'
    flavor: 'server'
    version: '2016'
  runtime:
    provider: 'appcontainer'
    image: 'cdpxwin.azurecr.io/global/vse2017u7/vse2017u7-external-winltsc2016-20190731:latest'
    source_mode: 'link'

version:
  major: 1
  minor: 0
  name: 'Service-Fabric-Observer'
  system: 'patch'

build:
  commands:
    - !!buildcommand
      name: 'Build FO'
      command: '..\build\scripts\build.cmd'
      fail_on_stderr: false
      artifacts:
        - from: '..\FabricObserver\x64\bin\Release'
          to: 'FO'
          include:
            - '**/*'
          signing_options:
            sign_inline: true
        - from: '..\FabricObserver\x64\bin\Release'
          to: 'SignedFO'
          include:
            - 'FabricObserver.exe'

test:
  commands:
    - !!testcommand
      name: 'VsTest FabricObserver Unit Tests'
      command: '..\build\scripts\test.cmd'
      fail_on_stderr: false
      logs:
        - to: 'FO-test-logs'
          include:
            - '**/*.trx'
            - '**/*.coverage'
      testresults:
        - from: '..\FabricObserverTests\bin\Release\TestResults'
          title: 'FabricObserver Unit Tests Results'
          type: 'vstest'
          include:
            - '**/*.trx'
            - '**/*.coverage'
